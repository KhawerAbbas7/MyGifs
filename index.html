<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GIF Library</title>
<style>
:root{
  --bg:#f4f6f8;
  --card:#fff;
  --text:#1a202c;
  --muted:#718096;
  --accent:#3182ce;
  --border:#e2e8f0;
  --shadow:0 6px 12px rgba(0,0,0,.08)
}
@media(prefers-color-scheme:dark){
  :root{
    --bg:#1a202c;
    --card:#2d3748;
    --text:#f7fafc;
    --muted:#a0aec0;
    --accent:#63b3ed;
    --border:#4a5568;
    --shadow:0 6px 12px rgba(0,0,0,.35)
  }
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  background:var(--bg);
  color:var(--text)
}
.container{max-width:1200px;margin:auto;padding:2rem}
header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  border-bottom:1px solid var(--border);
  margin-bottom:2rem;
  padding-bottom:1rem
}
h1{font-size:1.4rem;margin:0}
a{text-decoration:none;color:inherit}
.search{
  width:100%;
  padding:.9rem 1rem;
  border-radius:10px;
  border:2px solid var(--border);
  background:var(--card);
  color:var(--text);
  font-size:1rem;
  margin-bottom:2rem
}
.search:focus{outline:none;border-color:var(--accent)}
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(240px,1fr));
  gap:1.5rem
}
.card{
  background:var(--card);
  border-radius:14px;
  overflow:hidden;
  box-shadow:var(--shadow);
  cursor:pointer;
  transition:transform .15s,box-shadow .15s
}
.card:hover{transform:translateY(-4px);box-shadow:0 10px 18px rgba(0,0,0,.15)}
.thumb{
  aspect-ratio:16/9;
  background:var(--border)
}
.thumb img{width:100%;height:100%;object-fit:cover;display:block}
.card-title{
  padding:.8rem 1rem;
  font-size:.85rem;
  color:var(--muted);
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis
}
.hidden{display:none}
.detail{
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:1.5rem
}
.detail img{
  max-width:100%;
  max-height:80vh;
  border-radius:12px;
  box-shadow:var(--shadow)
}
.btn{
  background:var(--accent);
  color:#fff;
  border:none;
  border-radius:8px;
  padding:.6rem 1.4rem;
  font-size:.95rem;
  cursor:pointer
}
.btn.secondary{
  background:transparent;
  color:var(--accent);
  border:1px solid var(--accent)
}
.status{color:var(--muted);font-size:.9rem}
</style>
</head>
<body>
<div class="container">
  <header>
    <h1><a href="./">My GIFs</a></h1>
  </header>

  <section id="gallery">
    <input id="search" class="search" type="search" placeholder="Search GIFs…" aria-label="Search GIFs">
    <div id="grid" class="grid"></div>
    <div id="empty" class="status hidden">No GIFs found</div>
  </section>

  <section id="detail" class="detail hidden">
    <button id="back" class="btn secondary">← Back</button>
    <h2 id="title"></h2>
    <img id="image" alt="">
    <button id="copy" class="btn">Copy Link</button>
  </section>
</div>

<script>
const RAW="https://raw.githubusercontent.com/KhawerAbbas7/MyGifs/refs/heads/main/public/gifs/"
const API="https://wsrv.nl/?url="
const grid=document.getElementById("grid")
const gallery=document.getElementById("gallery")
const detail=document.getElementById("detail")
const search=document.getElementById("search")
const empty=document.getElementById("empty")
const img=document.getElementById("image")
const title=document.getElementById("title")
const copy=document.getElementById("copy")
const back=document.getElementById("back")
let gifs=[]
init()

function init(){
  fetch("gifs.json").then(r=>r.json()).then(d=>{
    gifs=d
    route()
  }).catch(()=>empty.textContent="Failed to load GIFs")
  window.addEventListener("popstate",route)
}

function route(){
  const p=new URLSearchParams(location.search)
  const v=p.get("view")
  v?showDetail(v):showGrid(gifs)
}

function showGrid(list){
  detail.classList.add("hidden")
  gallery.classList.remove("hidden")
  grid.innerHTML=""
  empty.classList.toggle("hidden",list.length>0)
  list.forEach(f=>{
    const raw=RAW+encodeURIComponent(f)
    const thumb=API+encodeURIComponent(raw)+"&w=400&h=300&fit=cover&output=jpg"
    const c=document.createElement("div")
    c.className="card"
    c.tabIndex=0
    c.onclick=()=>navigate(f)
    c.onkeydown=e=>e.key==="Enter"&&navigate(f)
    c.innerHTML=`<div class="thumb"><img src="${thumb}" loading="lazy" alt="${f}"></div><div class="card-title">${f}</div>`
    grid.appendChild(c)
  })
}

function showDetail(f){
  if(!gifs.includes(f)){history.replaceState(null,"","./");return}
  gallery.classList.add("hidden")
  detail.classList.remove("hidden")
  const url=RAW+encodeURIComponent(f)
  title.textContent=f
  img.src=""
  img.src=url+"?t="+Date.now()
  img.alt=f
  copy.onclick=()=>navigator.clipboard.writeText(url).then(()=>{
    copy.textContent="Copied"
    setTimeout(()=>copy.textContent="Copy Link",1500)
  })
}

function navigate(f){
  history.pushState(null,"","?view="+encodeURIComponent(f))
  showDetail(f)
}

let t
search.oninput=e=>{
  clearTimeout(t)
  t=setTimeout(()=>{
    const q=e.target.value.toLowerCase()
    showGrid(gifs.filter(g=>g.toLowerCase().includes(q)))
  },120)
}

back.onclick=()=>{history.pushState(null,"","./");showGrid(gifs)}
</script>
</body>
</html>